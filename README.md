
<!-- README.md is generated from README.Rmd. Please edit that file -->
drep
====

<!-- badges: start -->
<!-- badges: end -->
`drep` allows calculation of the Dengue Reproduction number, *R*<sub>0</sub>, from Force of Infection using the at-equilibrium number of primary, secondary, tertiary and quaternary infections in a population and their relative infectiousness. This is done assuming that Dengue transmission is at equilibrium.

Installation
------------

You can install the development version of the `drep` package using `devtools`. First install `devtools`, if you don't already have it.

``` r
install.packages("devtools")
library(devtools)
```

Then, in a fresh R session, install the `drep` package.

``` r
devtools::install_github("mrc-ide/drep")
```

Background
----------

Accurate estimates of transmission intensity of Dengue are needed to quantify the global burden of the disease and assess the impact of control strategies. Transmission intensity of an infectious disease is measured using the Force of Infection (the per capita rate at which susceptible individuals acquire infection, ***λ***) or the basic reproduction number (the average number of secondary infections generated by one primary case entering a susceptible population, *R*<sub>0</sub>). ***λ*** and *R*<sub>0</sub> are related through the age structure of the human host population. While ***λ*** is computed by accounting for the demographic structure of the human population, *R*<sub>0</sub> is normalized. Both these measures can be used to estimate the global burden of Dengue using a set of climatic and environmental predictors and a geostatistical model to produce a continuous surface of transmission intensity and calculate burden outputs (infections, symptomatic cases, hospitalizations). This package provides a set of functions to translate average force of infection (per serotype) into reproduction number. Future versions of the package will also allow to calculate burden estimates.

We make a number of assumptions:

1.  Four dengue serotypes are in circulation
2.  There is a maxiumum number of four dengue infections per individual
3.  Dengue transmission is at equilibrium
4.  Force of infection is constant through time

Example
-------

This is a basic example which shows you how to to convert Force of Infection into *R*<sub>0</sub>. To do this we need:

-   the age structure of the human population
-   the relative infectiousness of the four dengue infections.

We assume that the population is divided up into 20 age groups and define the following parameters:

-   number of age groups in the country human population (`n_age_groups`)
-   total human population of the country (`pop`)
-   the Force of Infection estimate (`FOI`)
-   the relative infectiousness of the four dengue infections (`phis`)

We asssume, as a starting point, that all four infections have the same infectiousness.

``` r
n_age_groups <- 20
pop <- 500000
FOI <- 0.0235
phis <- c(1, 1, 1, 1)
```

We then Simulate some data, including

-   the lower and upper age limits (`l_lim` and `u_lim`) of the country age groups
-   the number of individuals in each age group (`n_j`)
-   the proportion of individuals in each age gorup (`f_j`)

``` r
l_lim <- seq(0, 95, length.out = n_age_groups)
u_lim <- seq(5, 100, length.out = n_age_groups)
n_j <- sample(1:50, n_age_groups, replace = TRUE)
f_j <- n_j / sum(n_j)
```

The *R*<sub>0</sub> can be calculated using the `calculate_R0` function. The `calculate_R0` function takes six arguments:

-   `FOI`: a numeric value of the force of infection estimate, which represents the average estimate per serotype
-   `pop`: a numeric value representing the total human population of the country
-   `f_j`: a numeric vector of the proportions of individuals in each age gorup
-   `l_lim`: a numeric vector of the lower limits of the country age groups
-   `u_lim`: a numeric vector of the upper limits of the country age groups
-   `phis`: a numeric vector of the relative infectiousness of primary, secondary, tertiary and quaternary dengue infections.

``` r
R0 <- drep::calculate_R0(FOI, pop, f_j, u_lim, l_lim, phis)
R0
#> [1] 2.559932
```
