---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```
# drep

<!-- badges: start -->
[![Travis build status](https://travis-ci.org/mrc-ide/drep.svg?branch=master)](https://travis-ci.org/mrc-ide/drep)
[![Codecov test coverage](https://codecov.io/gh/mrc-ide/drep/branch/master/graph/badge.svg)](https://codecov.io/gh/mrc-ide/drep?branch=master)
<!-- badges: end -->

`drep` allows calculation of the reproduction number ($R_0$) of the dengue virus from 
force of infection using the at-equilibrium number of primary, secondary, tertiary 
and quaternary infections in a population and their relative infectiousness. 
This is done assuming that dengue transmission is at equilibrium. 

## Installation

You can install the development version of the `drep` package using `devtools`. First install `devtools`, if you don't already have it.

```{r include = TRUE, eval = FALSE}
install.packages("devtools")
library(devtools)
```

Then, in a fresh R session, install the `drep` package.

```{r include = TRUE, eval = FALSE}
devtools::install_github("mrc-ide/drep")
```

## Background 

Accurate estimates of transmission intensity of dengue are needed to quantify the global burden of the disease and assess the impact of control strategies. Transmission intensity of an infectious disease is measured using the force of infection (the per capita rate at which susceptible individuals acquire infection, $\lambda$) or the basic reproduction number (the average number of secondary infections generated by one primary case entering a susceptible population, $R_0$). $\lambda$ and $R_0$ are related through the age structure of the human host population. While $\lambda$ is computed by accounting for the demographic structure of the human population, $R_0$ is normalized. Both these measures can be used to estimate the global burden of dengue using a set of climatic and environmental predictors and a geostatistical model to produce a continuous surface of transmission intensity and calculate burden outputs (infections, symptomatic cases, hospitalizations). This package provides a set of functions to translate average force of infection (per serotype) into reproduction number. Future versions of the package will also allow calculation of burden estimates. 

We make a number of assumptions: 

1. four dengue serotypes are in circulation
2. there is a maxiumum number of four dengue infections per individual
3. dengue transmission is at equilibrium 
4. force of infection is constant through time

## Example

This is a basic example which shows you how to to convert force of infection 
into $R_0$. To do this we need:

* the proportion of the human population in different age groups
* the relative infectiousness of the four dengue infections. 

We assume that the human population is divided up into 20 age groups and define 
the following parameters:

* number of age groups in the country human population (`n_age_groups`)
* the force of infection estimate (`FOI`)
* the relative infectiousness of the four dengue infections (`phis`) 

We asssume, as a starting point, that all four infections have the same infectiousness. 

```{r}
n_age_groups <- 20
FOI <- 0.0235
phis <- c(1, 1, 1, 1)
```

We then simulate some data, including

* the lower and upper age limits (`l_lim` and `u_lim`) of the country age groups 
* the proportion of individuals in each age gorup (`f_j`)

```{r}
l_lim <- seq(0, 95, length.out = n_age_groups)
u_lim <- seq(5, 100, length.out = n_age_groups)
n_j <- sample(1:50, n_age_groups, replace = TRUE)
f_j <- n_j / sum(n_j)
f_j
```

The $R_0$ can be calculated using the `calculate_R0` function. The `calculate_R0` function takes six arguments:

* `FOI`: a numeric value of the force of infection estimate, which represents the average estimate per serotype
* `f_j`: a numeric vector of the proportions of individuals in each age group
* `l_lim`: a numeric vector of the lower limits of the country age groups
* `u_lim`: a numeric vector of the upper limits of the country age groups
* `phis`: a numeric vector of the relative infectiousness of the numbers of primary, secondary, tertiary and quaternary dengue infections. 

```{r}
R0 <- drep::calculate_R0(FOI, f_j, u_lim, l_lim, phis)
R0
```
