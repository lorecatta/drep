<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Varying infectiousness • drep</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Varying infectiousness">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">drep</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/burden.html">Burden estimation</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="../articles/drep.html">Get started</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mrc-ide/drep">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><script src="drep_files/kePrint-0.0.1/kePrint.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Varying infectiousness</h1>
                        <h4 class="author">Lorenzo Cattarino</h4>
            
            <h4 class="date">2019-06-17</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/mrc-ide/drep/blob/master/vignettes/drep.Rmd"><code>vignettes/drep.Rmd</code></a></small>
      <div class="hidden name"><code>drep.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>This vignette explains how to use <code>drep</code> to compute the dengue reproduction from force of infection using real data and under different assumptions regarding the relative infectiousness of the number of primary, secondary, tertiary and quaternary infections at endemic equlibrium.</p>
</div>
<div id="real-foi-data" class="section level2">
<h2 class="hasAnchor">
<a href="#real-foi-data" class="anchor"></a>Real FoI data</h2>
<p>Let’s now look at some real data. The <code>foi</code> dataset contains force of infection estimates for different locations in the world and it is available <a href="https://mrcdata.dide.ic.ac.uk/_dengue/dengue.php">here</a>.</p>
<table class="table">
<thead><tr>
<th style="text-align:right;">
data_id
</th>
<th style="text-align:left;">
type
</th>
<th style="text-align:right;">
longitude
</th>
<th style="text-align:right;">
latitude
</th>
<th style="text-align:left;">
ISO
</th>
<th style="text-align:right;">
ID_0
</th>
<th style="text-align:right;">
ID_1
</th>
<th style="text-align:right;">
FOI
</th>
<th style="text-align:right;">
population
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
serology
</td>
<td style="text-align:right;">
146.26014
</td>
<td style="text-align:right;">
-20.076964
</td>
<td style="text-align:left;">
AUS
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0.0029469
</td>
<td style="text-align:right;">
4489114
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
caseReport
</td>
<td style="text-align:right;">
-70.81200
</td>
<td style="text-align:right;">
-9.023796
</td>
<td style="text-align:left;">
BRA
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0006114
</td>
<td style="text-align:right;">
742042
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
serology
</td>
<td style="text-align:right;">
-67.05870
</td>
<td style="text-align:right;">
-10.076392
</td>
<td style="text-align:left;">
BRA
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0020941
</td>
<td style="text-align:right;">
742042
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
caseReport
</td>
<td style="text-align:right;">
-45.27442
</td>
<td style="text-align:right;">
-4.960950
</td>
<td style="text-align:left;">
BRA
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0.0615974
</td>
<td style="text-align:right;">
6947167
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
serology
</td>
<td style="text-align:right;">
-44.20998
</td>
<td style="text-align:right;">
-2.597735
</td>
<td style="text-align:left;">
BRA
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0.0032839
</td>
<td style="text-align:right;">
6947167
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
caseReport
</td>
<td style="text-align:right;">
-54.78515
</td>
<td style="text-align:right;">
-20.772230
</td>
<td style="text-align:left;">
BRA
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
0.0068457
</td>
<td style="text-align:right;">
2596730
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
caseReport
</td>
<td style="text-align:right;">
-56.92110
</td>
<td style="text-align:right;">
-12.681871
</td>
<td style="text-align:left;">
BRA
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
0.0406051
</td>
<td style="text-align:right;">
3232676
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
caseReport
</td>
<td style="text-align:right;">
-44.55503
</td>
<td style="text-align:right;">
-18.512178
</td>
<td style="text-align:left;">
BRA
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
0.0310419
</td>
<td style="text-align:right;">
20863245
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
caseReport
</td>
<td style="text-align:right;">
-54.93062
</td>
<td style="text-align:right;">
-1.998127
</td>
<td style="text-align:left;">
BRA
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
0.0295467
</td>
<td style="text-align:right;">
8046041
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
caseReport
</td>
<td style="text-align:right;">
-36.78195
</td>
<td style="text-align:right;">
-7.239961
</td>
<td style="text-align:left;">
BRA
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
0.0365367
</td>
<td style="text-align:right;">
3991856
</td>
</tr>
</tbody>
</table>
<p>The dataset contains nine variables.</p>
<ul>
<li>
<code>data_id</code> is an integer which represents the data point unique identifier</li>
<li>
<code>type</code> is a character string describing wheather the data was derived from a serology study (<code>serology</code>) or a case surveillance study (<code>caseReport</code>).</li>
<li>
<code>longitude</code> and <code>latitude</code> are the numeric geographic coordinates of the data points.</li>
<li>
<code>ISO</code> is a character string describing the ISO <strong>3166-1 alpha-3</strong> country code.</li>
<li>
<code>ID_0</code> and <code>ID_1</code> are integers representing the GADM administrative units unique identifiers sourced from <a href="http://gadm.org/">here</a>.</li>
<li>
<code>FOI</code> is the force of infection estimate</li>
<li>
<code>population</code> is the Level 1 administrative unit population according to 2015 <a href="http://web.ornl.gov/sci/landscan/">Landscan data</a>
</li>
</ul>
<p>Information on the demographic structure of the population to which the original force of infection estimate refers is needed to convert force of infection into reproduction number. The <code>age_structure</code> dataset contains the country-level <strong>number</strong> of individuals in twenty 5-year age groups (0-99) from 2015, sourced from the United Nation Department of Economic and Social Affairs <a href="https://population.un.org/wpp/Download/Standard/Population/">link</a>. The number in each age group is a different variable. The other important variable is <code>ID_0</code>, which represents the country unique identifier.</p>
<table class="table table table-striped">
<thead><tr>
<th style="text-align:right;">
ID_0
</th>
<th style="text-align:right;">
band_0_4
</th>
<th style="text-align:right;">
band_5_9
</th>
<th style="text-align:right;">
band_10_14
</th>
<th style="text-align:right;">
band_15_19
</th>
<th style="text-align:right;">
band_20_24
</th>
<th style="text-align:right;">
band_25_29
</th>
<th style="text-align:right;">
band_30_34
</th>
<th style="text-align:right;">
band_35_39
</th>
<th style="text-align:right;">
band_40_44
</th>
<th style="text-align:right;">
band_45_49
</th>
<th style="text-align:right;">
band_50_54
</th>
<th style="text-align:right;">
band_55_59
</th>
<th style="text-align:right;">
band_60_64
</th>
<th style="text-align:right;">
band_65_69
</th>
<th style="text-align:right;">
band_70_74
</th>
<th style="text-align:right;">
band_75_79
</th>
<th style="text-align:right;">
band_80_84
</th>
<th style="text-align:right;">
band_85_89
</th>
<th style="text-align:right;">
band_90_94
</th>
<th style="text-align:right;">
band_95_99
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.1521859
</td>
<td style="text-align:right;">
0.1507409
</td>
<td style="text-align:right;">
0.1374900
</td>
<td style="text-align:right;">
0.1178442
</td>
<td style="text-align:right;">
0.0938326
</td>
<td style="text-align:right;">
0.0756318
</td>
<td style="text-align:right;">
0.0633954
</td>
<td style="text-align:right;">
0.0514358
</td>
<td style="text-align:right;">
0.0403370
</td>
<td style="text-align:right;">
0.0319744
</td>
<td style="text-align:right;">
0.0253028
</td>
<td style="text-align:right;">
0.0198610
</td>
<td style="text-align:right;">
0.0152801
</td>
<td style="text-align:right;">
0.0115600
</td>
<td style="text-align:right;">
0.0069483
</td>
<td style="text-align:right;">
0.0038123
</td>
<td style="text-align:right;">
0.0016910
</td>
<td style="text-align:right;">
0.0005534
</td>
<td style="text-align:right;">
0.0001230
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0.0639254
</td>
<td style="text-align:right;">
0.0535591
</td>
<td style="text-align:right;">
0.0677263
</td>
<td style="text-align:right;">
0.0891500
</td>
<td style="text-align:right;">
0.0939876
</td>
<td style="text-align:right;">
0.0798203
</td>
<td style="text-align:right;">
0.0601244
</td>
<td style="text-align:right;">
0.0532135
</td>
<td style="text-align:right;">
0.0597789
</td>
<td style="text-align:right;">
0.0642709
</td>
<td style="text-align:right;">
0.0708362
</td>
<td style="text-align:right;">
0.0659986
</td>
<td style="text-align:right;">
0.0539046
</td>
<td style="text-align:right;">
0.0407740
</td>
<td style="text-align:right;">
0.0331721
</td>
<td style="text-align:right;">
0.0262612
</td>
<td style="text-align:right;">
0.0148583
</td>
<td style="text-align:right;">
0.0065653
</td>
<td style="text-align:right;">
0.0017277
</td>
<td style="text-align:right;">
0.0003455
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.1157191
</td>
<td style="text-align:right;">
0.0962309
</td>
<td style="text-align:right;">
0.0734401
</td>
<td style="text-align:right;">
0.0758855
</td>
<td style="text-align:right;">
0.0903819
</td>
<td style="text-align:right;">
0.0947687
</td>
<td style="text-align:right;">
0.0903063
</td>
<td style="text-align:right;">
0.0767931
</td>
<td style="text-align:right;">
0.0621455
</td>
<td style="text-align:right;">
0.0528678
</td>
<td style="text-align:right;">
0.0449515
</td>
<td style="text-align:right;">
0.0364553
</td>
<td style="text-align:right;">
0.0306820
</td>
<td style="text-align:right;">
0.0201437
</td>
<td style="text-align:right;">
0.0153536
</td>
<td style="text-align:right;">
0.0118492
</td>
<td style="text-align:right;">
0.0075381
</td>
<td style="text-align:right;">
0.0033279
</td>
<td style="text-align:right;">
0.0009580
</td>
<td style="text-align:right;">
0.0002017
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0.1885541
</td>
<td style="text-align:right;">
0.1572616
</td>
<td style="text-align:right;">
0.1307250
</td>
<td style="text-align:right;">
0.1072656
</td>
<td style="text-align:right;">
0.0875230
</td>
<td style="text-align:right;">
0.0719767
</td>
<td style="text-align:right;">
0.0589481
</td>
<td style="text-align:right;">
0.0478379
</td>
<td style="text-align:right;">
0.0376868
</td>
<td style="text-align:right;">
0.0300136
</td>
<td style="text-align:right;">
0.0243386
</td>
<td style="text-align:right;">
0.0195828
</td>
<td style="text-align:right;">
0.0151866
</td>
<td style="text-align:right;">
0.0098313
</td>
<td style="text-align:right;">
0.0067541
</td>
<td style="text-align:right;">
0.0039565
</td>
<td style="text-align:right;">
0.0018384
</td>
<td style="text-align:right;">
0.0005995
</td>
<td style="text-align:right;">
0.0001199
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
0.0769231
</td>
<td style="text-align:right;">
0.0769231
</td>
<td style="text-align:right;">
0.0879121
</td>
<td style="text-align:right;">
0.0879121
</td>
<td style="text-align:right;">
0.0879121
</td>
<td style="text-align:right;">
0.0769231
</td>
<td style="text-align:right;">
0.0659341
</td>
<td style="text-align:right;">
0.0549451
</td>
<td style="text-align:right;">
0.0769231
</td>
<td style="text-align:right;">
0.0879121
</td>
<td style="text-align:right;">
0.0659341
</td>
<td style="text-align:right;">
0.0549451
</td>
<td style="text-align:right;">
0.0329670
</td>
<td style="text-align:right;">
0.0219780
</td>
<td style="text-align:right;">
0.0219780
</td>
<td style="text-align:right;">
0.0109890
</td>
<td style="text-align:right;">
0.0109890
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
0.0856485
</td>
<td style="text-align:right;">
0.0838056
</td>
<td style="text-align:right;">
0.0825155
</td>
<td style="text-align:right;">
0.0791983
</td>
<td style="text-align:right;">
0.0796360
</td>
<td style="text-align:right;">
0.0768487
</td>
<td style="text-align:right;">
0.0734623
</td>
<td style="text-align:right;">
0.0742225
</td>
<td style="text-align:right;">
0.0620364
</td>
<td style="text-align:right;">
0.0543654
</td>
<td style="text-align:right;">
0.0505183
</td>
<td style="text-align:right;">
0.0467865
</td>
<td style="text-align:right;">
0.0418106
</td>
<td style="text-align:right;">
0.0348537
</td>
<td style="text-align:right;">
0.0270214
</td>
<td style="text-align:right;">
0.0201336
</td>
<td style="text-align:right;">
0.0142133
</td>
<td style="text-align:right;">
0.0084773
</td>
<td style="text-align:right;">
0.0035245
</td>
<td style="text-align:right;">
0.0009214
</td>
</tr>
<tr>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
0.0685885
</td>
<td style="text-align:right;">
0.0626243
</td>
<td style="text-align:right;">
0.0526839
</td>
<td style="text-align:right;">
0.0593108
</td>
<td style="text-align:right;">
0.0851557
</td>
<td style="text-align:right;">
0.0937707
</td>
<td style="text-align:right;">
0.0838304
</td>
<td style="text-align:right;">
0.0669317
</td>
<td style="text-align:right;">
0.0563287
</td>
<td style="text-align:right;">
0.0566600
</td>
<td style="text-align:right;">
0.0778661
</td>
<td style="text-align:right;">
0.0728960
</td>
<td style="text-align:right;">
0.0550033
</td>
<td style="text-align:right;">
0.0318091
</td>
<td style="text-align:right;">
0.0168986
</td>
<td style="text-align:right;">
0.0308151
</td>
<td style="text-align:right;">
0.0182240
</td>
<td style="text-align:right;">
0.0076209
</td>
<td style="text-align:right;">
0.0026508
</td>
<td style="text-align:right;">
0.0003313
</td>
</tr>
<tr>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
0.0480769
</td>
<td style="text-align:right;">
0.0673077
</td>
<td style="text-align:right;">
0.0673077
</td>
<td style="text-align:right;">
0.0769231
</td>
<td style="text-align:right;">
0.0673077
</td>
<td style="text-align:right;">
0.0480769
</td>
<td style="text-align:right;">
0.0576923
</td>
<td style="text-align:right;">
0.0673077
</td>
<td style="text-align:right;">
0.0769231
</td>
<td style="text-align:right;">
0.0769231
</td>
<td style="text-align:right;">
0.0865385
</td>
<td style="text-align:right;">
0.0769231
</td>
<td style="text-align:right;">
0.0673077
</td>
<td style="text-align:right;">
0.0480769
</td>
<td style="text-align:right;">
0.0288462
</td>
<td style="text-align:right;">
0.0192308
</td>
<td style="text-align:right;">
0.0096154
</td>
<td style="text-align:right;">
0.0096154
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
0.0645081
</td>
<td style="text-align:right;">
0.0635484
</td>
<td style="text-align:right;">
0.0589585
</td>
<td style="text-align:right;">
0.0620462
</td>
<td style="text-align:right;">
0.0700993
</td>
<td style="text-align:right;">
0.0748560
</td>
<td style="text-align:right;">
0.0741467
</td>
<td style="text-align:right;">
0.0642577
</td>
<td style="text-align:right;">
0.0713511
</td>
<td style="text-align:right;">
0.0642994
</td>
<td style="text-align:right;">
0.0670951
</td>
<td style="text-align:right;">
0.0610448
</td>
<td style="text-align:right;">
0.0534507
</td>
<td style="text-align:right;">
0.0496537
</td>
<td style="text-align:right;">
0.0355921
</td>
<td style="text-align:right;">
0.0264124
</td>
<td style="text-align:right;">
0.0194025
</td>
<td style="text-align:right;">
0.0125595
</td>
<td style="text-align:right;">
0.0055495
</td>
<td style="text-align:right;">
0.0011683
</td>
</tr>
<tr>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
0.0473013
</td>
<td style="text-align:right;">
0.0464817
</td>
<td style="text-align:right;">
0.0483550
</td>
<td style="text-align:right;">
0.0538579
</td>
<td style="text-align:right;">
0.0633415
</td>
<td style="text-align:right;">
0.0649807
</td>
<td style="text-align:right;">
0.0674394
</td>
<td style="text-align:right;">
0.0632244
</td>
<td style="text-align:right;">
0.0709519
</td>
<td style="text-align:right;">
0.0832455
</td>
<td style="text-align:right;">
0.0807868
</td>
<td style="text-align:right;">
0.0687273
</td>
<td style="text-align:right;">
0.0539749
</td>
<td style="text-align:right;">
0.0504625
</td>
<td style="text-align:right;">
0.0499941
</td>
<td style="text-align:right;">
0.0366468
</td>
<td style="text-align:right;">
0.0247044
</td>
<td style="text-align:right;">
0.0169769
</td>
<td style="text-align:right;">
0.0074933
</td>
<td style="text-align:right;">
0.0010537
</td>
</tr>
</tbody>
</table>
<p>For the purpose of this example, we pick the fourth data point, i.e. a <code>caseReport</code> estimate from Brazil.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lambda &lt;-<span class="st"> </span>drep<span class="op">::</span>foi[<span class="dv">4</span>, <span class="st">"FOI"</span>] <span class="co"># a point from Brazil</span>
lambda
<span class="co">#&gt; [1] 0.06159744</span></code></pre></div>
<p>The <code>ID_0</code> of the point selected from the <code>foi</code> dataset (<code>lambda</code>) is needed to be able to look up the correct demographic structure from the <code>age_structure</code> dataset.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">id_<span class="dv">0</span> &lt;-<span class="st"> </span>drep<span class="op">::</span>foi[<span class="dv">4</span>, <span class="st">"ID_0"</span>]
age_s_data &lt;-<span class="st"> </span>drep<span class="op">::</span>age_structure
n_j &lt;-<span class="st"> </span>age_s_data[age_s_data<span class="op">$</span>ID_<span class="dv">0</span> <span class="op">==</span><span class="st"> </span>id_<span class="dv">0</span>, <span class="dv">2</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">ncol</a></span>(age_s_data)]</code></pre></div>
<p>The age astructure for <code>lambda</code> looks like this:</p>
<table class="table table table-striped">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
band_0_4
</th>
<th style="text-align:right;">
band_5_9
</th>
<th style="text-align:right;">
band_10_14
</th>
<th style="text-align:right;">
band_15_19
</th>
<th style="text-align:right;">
band_20_24
</th>
<th style="text-align:right;">
band_25_29
</th>
<th style="text-align:right;">
band_30_34
</th>
<th style="text-align:right;">
band_35_39
</th>
<th style="text-align:right;">
band_40_44
</th>
<th style="text-align:right;">
band_45_49
</th>
<th style="text-align:right;">
band_50_54
</th>
<th style="text-align:right;">
band_55_59
</th>
<th style="text-align:right;">
band_60_64
</th>
<th style="text-align:right;">
band_65_69
</th>
<th style="text-align:right;">
band_70_74
</th>
<th style="text-align:right;">
band_75_79
</th>
<th style="text-align:right;">
band_80_84
</th>
<th style="text-align:right;">
band_85_89
</th>
<th style="text-align:right;">
band_90_94
</th>
<th style="text-align:right;">
band_95_99
</th>
</tr></thead>
<tbody><tr>
<td style="text-align:left;">
24
</td>
<td style="text-align:right;">
0.0723249
</td>
<td style="text-align:right;">
0.0741339
</td>
<td style="text-align:right;">
0.0838289
</td>
<td style="text-align:right;">
0.0840262
</td>
<td style="text-align:right;">
0.0802011
</td>
<td style="text-align:right;">
0.0837182
</td>
<td style="text-align:right;">
0.0857198
</td>
<td style="text-align:right;">
0.0783632
</td>
<td style="text-align:right;">
0.0688992
</td>
<td style="text-align:right;">
0.0634767
</td>
<td style="text-align:right;">
0.0593918
</td>
<td style="text-align:right;">
0.0485903
</td>
<td style="text-align:right;">
0.0389097
</td>
<td style="text-align:right;">
0.0287336
</td>
<td style="text-align:right;">
0.0201357
</td>
<td style="text-align:right;">
0.0147325
</td>
<td style="text-align:right;">
0.0086413
</td>
<td style="text-align:right;">
0.0044698
</td>
<td style="text-align:right;">
0.001429
</td>
<td style="text-align:right;">
0.0002742
</td>
</tr></tbody>
</table>
<p>Lets’s also define the lower and upper age limits (<code>l_lim</code> and <code>u_lim</code>) of the country age groups and the infectiousness weights (<code>phis</code>)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n_age_groups &lt;-<span class="st"> </span><span class="dv">20</span>
l_lim &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">0</span>, <span class="dv">95</span>, <span class="dt">length.out =</span> n_age_groups)
u_lim &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">5</span>, <span class="dv">100</span>, <span class="dt">length.out =</span> n_age_groups)
phis &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)</code></pre></div>
<p>Now we can compute the <span class="math inline">\(R_0\)</span>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">R0 &lt;-<span class="st"> </span>drep<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/drep/topics/calculate_R0">calculate_R0</a></span>(lambda, n_j, u_lim, l_lim, phis)
R0
<span class="co">#&gt; [1] 4.068688</span></code></pre></div>
</div>
<div id="varying-infectiousness" class="section level2">
<h2 class="hasAnchor">
<a href="#varying-infectiousness" class="anchor"></a>Varying infectiousness</h2>
<p>Now we explore the case when primary to quaternary numbers of infections have different relative infectiousness. First, we assume that only primary and secondary infections are infectious and therefore contribute to transmission. This implies that tertiary and secondary infections are not infectious.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">phis &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>)

R0 &lt;-<span class="st"> </span>drep<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/drep/topics/calculate_R0">calculate_R0</a></span>(lambda, n_j, u_lim, l_lim, phis)
R0
<span class="co">#&gt; [1] 8.173763</span></code></pre></div>
<p>The <span class="math inline">\(R_0\)</span> value increases relative to when using same weights because the virus has only two attempts at generating a given force of infection, so it has to have a higher <span class="math inline">\(R_0\)</span>.</p>
<p>Second, let’s assume that all four infections are infectious but symptomatic infections are twice as infectious as asymptomatic ones. This requires knowledge of the proportion of primary. secondary, tertiary and quaternary infections which are asymptomatic. We source the values of these parameters from <a href="https://science.sciencemag.org/content/353/6303/1033">Ferguson et al. 2016</a> and put them in a vector.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">prop_sym_parms &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.45</span>, <span class="fl">0.85</span>, <span class="fl">0.15</span>, <span class="fl">0.15</span>)</code></pre></div>
<p>We can use the function <code>calculate_infectiousness_sym_2x_asym</code> to calculate the relative infectiousness of the four dengue infections from the proportion of primary. secondary, tertiary and quaternary infectionsa which are asymptomatic.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">phis &lt;-<span class="st"> </span>drep<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/drep/topics/calculate_infectiousness_sym_2x_asym">calculate_infectiousness_sym_2x_asym</a></span>(prop_sym_parms)

phis
<span class="co">#&gt; [1] 0.7837838 1.0000000 0.6216216 0.6216216</span></code></pre></div>
<p>Now the reproduction number is</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">R0 &lt;-<span class="st"> </span>drep<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/drep/topics/calculate_R0">calculate_R0</a></span>(lambda, n_j, u_lim, l_lim, phis)
R0
<span class="co">#&gt; [1] 5.372142</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#real-foi-data">Real FoI data</a></li>
      <li><a href="#varying-infectiousness">Varying infectiousness</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Lorenzo Cattarino.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
